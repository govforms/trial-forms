{
  "_id": "template-al100-automation",
  "formName": "Send your Aggregates Levy return online",
  "description": "Fill in your aggregates levy return form online",
  "formCategory": "hmrcReturnForm",
  "developmentPhase": "beta",
  "emailTemplateId": "al100_return_confirmation",
  "authConfig": {
    "authModule": "hmrc",
    "agentAccess": "allowAnyAgentAffinityUser",
    "enrolmentCheck": "always",
    "serviceId": "HMRC-OBTDS-ORG",
    "regimeId": "AL",
    "enrolmentSection": {
      "title": "Register for Enrolment",
      "fields": [
        {
          "id": "etmpRegistrationNumber",
          "type": "text",
          "label": "Enter your AGL number",
          "format": "text(15, 15)"
        },
        {
          "id": "businessPostcode",
          "type": "text",
          "label": "Enter the postcode of your primary place of business",
          "infoText": "This is the postcode you gave to HMRC when you registered for Aggregates Levy",
          "format": "text(5, 8)",
          "mandatory": "true"
        }
      ],
      "identifiers": [
        {
          "value": "${etmpRegistrationNumber}",
          "key": "EtmpRegistrationNumber"
        }
      ],
      "verifiers": [
        {
          "value": "${businessPostcode}",
          "key": "BusinessPostcode"
        }
      ]
    }
  },
  "sections": [
    {
      "title": "Enter your client's reference number (also known as an access code)",
      "includeIf": "${user.affinityGroup = 'agent'}",
      "fields": [
        {
          "id": "accessCode",
          "type": "text",
          "label": "Access code",
          "value": "${eeitt.agent}",
          "submitMode": "derived"
        },
        {
          "id": "aggregatesLevyRegAgent",
          "type": "text",
          "label": "Client's aggregates levy reference number",
          "helpText": "This begins with X and is followed by 3 letters, 5 zeroes and 6 other numbers, for example XABC00000123456"
        }
      ]
    },
    {
      "title": "Choose your client's Aggregates Levy return dates",
      "includeIf": "${user.affinityGroup = 'agent'}",
      "description": "The return dates are on the notice to file letter we sent out telling your client when their return is due.",
      "fields": [
        {
          "id": "returnPeriodAgent",
          "type": "hmrcTaxPeriod",
          "label": "Select tax period",
          "idType": "eeits",
          "idNumber": "$(aggregatesLevyRegAgent)",
          "regimeType": "AGL"
        }
      ]
    },
    {
      "title": "Choose your Aggregates Levy return dates",
      "includeIf": "${user.affinityGroup = 'organisation' || user.affinityGroup = 'individual'}",
      "description": "The return dates are on the notice to file letter we sent out telling you when your return is due.",
      "fields": [
        {
          "id": "returnPeriod",
          "type": "hmrcTaxPeriod",
          "label": "Select tax period",
          "idType": "eeits",
          "idNumber": "${user.enrolledIdentifier}",
          "regimeType": "AGL"
        }
      ]
    },
    {
      "title": "About you",
      "includeIf": "${user.affinityGroup = 'agent'}",
      "fields": [
        {
          "id": "yourInfoAgent",
          "type": "info",
          "label": "",
          "infoText": "HMRC will use these details if we need to discuss this return. ",
          "infoType": "noformat"
        },
        {
          "id": "regContactNameAgent",
          "type": "text",
          "label": "Full name"
        },
        {
          "id": "RegPhoneNumberAgent",
          "type": "text",
          "label": "Telephone number",
          "format": "telephoneNumber"
        },
        {
          "id": "regEmailAgent",
          "type": "text",
          "label": "Email address (optional)",
          "format": "email",
          "mandatory": "false"
        },
        {
          "id": "positionInTheCompanyAgent",
          "type": "text",
          "label": "Your position in the company",
          "shortName": "Position in the company",
          "helpText": "For example, a company director.",
          "mandatory": "true"
        }
      ]
    },
    {
      "title": "About you",
      "includeIf": "${user.affinityGroup = 'organisation' || user.affinityGroup = 'individual'}",
      "fields": [
        {
          "id": "aggregatesLevyReg",
          "type": "text",
          "label": "Aggregates Levy registration number",
          "value": "${user.enrolledIdentifier}",
          "submitMode": "derived"
        },
        {
          "id": "yourInfo",
          "type": "info",
          "label": "",
          "infoText": "HMRC will use these details if we need to discuss this return. ",
          "infoType": "noformat"
        },
        {
          "id": "regContactName",
          "type": "text",
          "label": "Full name"
        },
        {
          "id": "RegPhoneNumber",
          "type": "text",
          "label": "Telephone number",
          "format": "telephoneNumber"
        },
        {
          "id": "regEmail",
          "type": "text",
          "label": "Email address (optional)",
          "format": "email",
          "mandatory": "false"
        },
        {
          "id": "positionInTheCompanyBusiness",
          "type": "text",
          "label": "Your position in the company",
          "shortName": "Position in company",
          "helpText": "For example, a company director.",
          "mandatory": "true"
        }
      ]
    },
    {
      "title": "Provide your Aggregates Levy due for the return period",
      "shortName": "Aggregates Levy due for the return period",
      "fields": [
        {
          "id": "levyDueForThisPeriod",
          "type": "text",
          "label": "Levy due for this period",
          "shortName": "Levy due",
          "helpText": "Enter the total amount of Aggregates Levy due deducting any reliefs. You can make adjustments where you've paid too little or too much levy on previous returns.",
          "format": "sterling"
        },
        {
          "id": "insetInfoBox",
          "type": "info",
          "label": "",
          "infoText": "You can include adjustments of up to Â£50,000 as long as it's not over 1% of the total sales on your VAT Return for the return period in which you're adjusting."
        }
      ]
    },
    {
      "title": "Provide your aggregates weight in tonnes for the return period",
      "shortName": "Aggregates weight in tonnes for the return period",
      "description": "Provide the aggregate comercially exploited, and relieved and exempted from the levy in tonnes.",
      "fields": [
        {
          "id": "taxableAggregateExploitedThisPeriod",
          "type": "text",
          "label": "Aggregate commercially exploited in tonnes",
          "shortName": "Commercially exploited",
          "helpText": "Include any aggregate that is or may become eligible for relief.",
          "format": "number(10, 0)",
          "mandatory": "true"
        },
        {
          "id": "TonnesOfRelievedAggregateThisPeriod",
          "type": "text",
          "label": "Relieved aggregate in tonnes",
          "shortName": "Relieved",
          "helpText": "Include exported aggregate.",
          "format": "number",
          "mandatory": "true"
        },
        {
          "id": "TonnesOfExemptAggregateThisPeriod",
          "type": "text",
          "label": "Exempt aggregate in tonnes",
          "shortName": "Exempt",
          "format": "number",
          "mandatory": "true"
        }
      ]
    }
  ],
  "declarationSection": {
    "title": "Confirm details and send your return",
    "shortName": "Declaration",
    "fields": [
      {
        "id": "declaration-firstname",
        "type": "text",
        "label": "Full Name"
      },
      {
        "id": "declaration-status",
        "type": "text",
        "label": "Job title",
        "helpText": "For example, a company director."
      },
      {
        "id": "email",
        "type": "text",
        "label": "Email address",
        "format": "email",
        "mandatory": "true"
      },
      {
        "id": "decPageContent",
        "type": "info",
        "label": "",
        "infoText": "# Declaration \nBy submitting this return, you declare that the information that you have provided is true and complete.",
        "infoType": "noformat"
      },
      {
        "id": "decPageImportant",
        "type": "info",
        "label": "",
        "infoText": "Send your return and payment by the due date to avoid financial penalties. \n\nIf you give incomplete or inaccurate information, we may charge a financial penalty or even prosecute you.",
        "infoType": "important"
      }
    ]
  },
  "acknowledgementSection": {
    "title": "Acknowledgement Page",
    "shortName": "Acknowledgement Page",
    "fields": [
      {
        "id": "ackpageInfo",
        "type": "info",
        "label": "Payment",
        "infoText": "Make a payment\n\nIf you have already set up a Direct Debit for this tax, you don't need to do anything else. Your payment will be collected automatically from your bank.\n\nYou can also use BACS, CHAPS or Faster Payments to pay. Make sure to include your 15 digit registration number on any payment.\n\nAccount details:\n\nAccount name: HMRC Aggregates Levy\n\nAccount number:11963171\n\nSort code: 08 32 00\n\nPayment reference: Include your 15 digit registration number  "
      },
      {
        "id": "ackpageSurvey",
        "type": "info",
        "label": "",
        "infoText": "[What do you think of this service?](https://www.surveygizmo.com/s3/4708003/Feedback-Survey-Aggregates-Levy) (takes 1 minute)",
        "infoType": "noformat"
      }
    ]
  },
  "destinations": [
    {
      "id": "eeittReturnApi",
      "type": "handlebarsHttpApi",
      "failOnError": false,
      "profile": "des",
      "convertSingleQuotes": true,
      "uri": "cross-regime/return/AGL/eeits/{{either2 aggregatesLevyReg aggregatesLevyRegAgent}}",
      "method": "POST",
      "payload": "{'periodKey':'{{hmrcTaxPeriodKey returnPeriod}}','periodFrom':'{{hmrcTaxPeriodFromDate returnPeriod}}','periodTo':'{{hmrcTaxPeriodToDate returnPeriod}}','returnsDetails':{'isrScenario':'ZAG1','regimeSpecificDetails':[{'paramSequence':'01','paramName':'A_REGISTRATION_NUMBER','paramValue':'{{either2 aggregatesLevyReg aggregatesLevyRegAgent}}'},{'paramSequence':'01','paramName':'A_RET_TYPE','paramValue':'1'},{'paramSequence':'01','paramName':'A_AGL_LEVY_DUE','paramValue':'{{levyDueForThisPeriod}}'},{'paramSequence':'01','paramName':'A_AGL_TAXABLE_TON','paramValue':'{{taxableAggregateExploitedThisPeriod}}'},{'paramSequence':'01','paramName':'A_AGL_RELIEVED_TON','paramValue':'{{TonnesOfRelievedAggregateThisPeriod}}'},{'paramSequence':'01','paramName':'A_AGL_EXEMPT_TON','paramValue':'{{TonnesOfExemptAggregateThisPeriod}}'},{'paramSequence':'01','paramName':'A_DATA_ORIGIN','paramValue':'1'}]},'receivedAt':'{{getCurrentTimestamp}}'}"
    },
    {
      "id": "HMRCDMS",
      "type": "hmrcDms",
      "includeIf": "{{isNotSuccessCode eeittReturnApi.status}}",
      "dmsFormId": "AL100",
      "customerId": "${' '}",
      "classificationType": "BT-NRU-Environmental",
      "businessArea": "BT"
    }
  ],
  "submitErrorUrl": "http://www.yahoo.co.uk",
  "submitSuccessUrl": "http://www.google.co.uk"
}